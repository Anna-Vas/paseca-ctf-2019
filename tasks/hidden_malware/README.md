# hidden-malware
### Решение
В трафике находим сеанс общения c&c с клиентом. Там же зашифрованный флаг. 
- `py -2 vol.py --file C:\Users\madrat\Desktop\paseca-ctf\tasks\hidden_malware\dumps\memdump_Copy.mem imageinfo`
- `py -2 vol.py --file C:\Users\madrat\Desktop\paseca-ctf\tasks\hidden_malware\dumps\memdump_Copy.mem --profile=Win7SP1x64`
- `py -2 vol.py --file C:\Users\madrat\Desktop\paseca-ctf\tasks\hidden_malware\dumps\memdump_Copy.mem --profile=Win7SP1x64 pslist`
- `py -2 vol.py --file C:\Users\madrat\Desktop\paseca-ctf\tasks\hidden_malware\dumps\memdump_Copy.mem --profile=Win7SP1x64 netscan` - находим explorer.exe который какого-то фига открыл порт 63792. Понимаем, что что-то не так...
- `py -2 vol.py --file C:\Users\madrat\Desktop\paseca-ctf\tasks\hidden_malware\dumps\memdump_Copy.mem --profile=Win7SP1x64 dlllist` - встречаем модуль updater у explorer.exe
- `py -2 vol.py --file C:\Users\madrat\Desktop\paseca-ctf\tasks\hidden_malware\dumps\memdump_Copy.mem --profile=Win7SP1x64 dlldump -D dlls/` - дампим все dll-ки и достаем нужную по смещению 0x7fef0f40000
- Реверсим. Узнаем, что за алгоритм (RC4). Достаем ключ. Расшифровываем. 

### Легенда
Кто-то скачал файлик и запустил... Удалился очень важный файл. Восстановите, если сможете. Также CNC сервер больше не выходит на связь.