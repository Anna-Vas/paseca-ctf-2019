#include "StartupAdder.h"

int StartupAdder::add(std::string appName, std::string path)
{
	HKEY hKey = NULL;
	LONG createStatus = RegCreateKey(HKEY_CURRENT_USER, "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", &hKey);

	if (ERROR_SUCCESS == createStatus)
	{
		LONG status = RegSetValueEx(hKey, "Updater", 0, REG_SZ, (LPBYTE)path.c_str(), (path.size() + 1) * sizeof(wchar_t));
		RegCloseKey(hKey);
	}
	else {
		return 1;
	}

	return 0;
}
