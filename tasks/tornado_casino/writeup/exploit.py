import socket
from randcrack import RandCrack


sock = socket.socket()
sock.connect(('task.pase.ca',24028))
sock.recv(10000)
sock.send(b'2\n')
sock.recv(1000)
sock.send(b'b33_1_4m_b3333\n')
sock.recv(200)
sock.send(b'1\n')
sock.recv(500)

states = []
rc = RandCrack()
for i in range(624):
    sock.send(b'$\n')
    sock.recv(100)
    sock.send(b'a\n')
    data = sock.recv(100)
    state = int(''.join(data.split(b'\n')[0].decode('ascii').split('|')), 16)
    rc.submit(state)
win = bytes(hex(rc.predict_getrandbits(32))[2:].encode('ascii'))
sock.send(b'$\n')
sock.recv(100)
sock.send(win + b'\n')
data = sock.recv(1024)
print(data.split(b'\n')[-2])
